<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>medication-in-SPARC</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">medication-in-SPARC</h1>



<p>A Study of a Prospective Adult Research Cohort with Inflammatory
Bowel Disease (SPARC IBD) is a longitudinal study following adult IBD
patients as they receive care at 17 different sites across the United
States. To learn more about SPARC IBD and it’s development please see
[The Development and Initial Findings of A Study of a Prospective Adult
Research Cohort with Inflammatory Bowel Disease (SPARC IBD)] (<a href="https://doi.org/10.1093/ibd/izab071" class="uri">https://doi.org/10.1093/ibd/izab071</a>).</p>
<p>Data from patient reported surveys (eCRFs), IBD Smartform and
electronic medication records (EMR) are integrated into IBD Plexus. The
ibdplexus package was created to synthesize this data into research
ready formats. This vignette focuses on the functions in the ibdplexus
package that handle the medication information in SPARC IBD.</p>
<p>Patient reported surveys, sent out at enrollment and quarterly, ask
patients about their current IBD medication use specifically. Electronic
medical records, when available, contain the prescriptions for each
patient from that institution. They may not be prescribed specifically
for IBD. The Smartform, updated at the time of office visit by the
provider, asks for exposure to specific IBD medications.</p>
<p>This vignette mainly focuses on the medication data from eCRF and
EMR.</p>
<div id="filtering-for-medications-of-interest" class="section level1">
<h1>Filtering for Medications of Interest</h1>
<p><code>sparc_med_filter</code> filters through the eCRF and EMR data
for medications of interest that are listed in the data.frame
<code>med_grp</code>.</p>
<p><code>med grp</code> contains the medication name of interest, the
type of medication and a standardized name. The MEDICATION_NAME column
includes generic and brand names. the new_med_name column is the
standardized name for each MEDICATION_NAME. Currently, all biosimilars
are mapped to the generic name.</p>
<p>A future iteration will parse out biosimilars into their own
group.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ibdplexus, <span class="at">quietly =</span> T)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse, <span class="at">quietly =</span> T)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Here is the table of the medication types in med_grp</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(med_grp <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(med_type)) </span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">med_type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Biologic</td>
</tr>
<tr class="even">
<td align="left">Antibiotics</td>
</tr>
<tr class="odd">
<td align="left">Immunomodulators</td>
</tr>
<tr class="even">
<td align="left">Aminosalicylates</td>
</tr>
<tr class="odd">
<td align="left">Corticosteroids</td>
</tr>
<tr class="even">
<td align="left">Antidiarrheals</td>
</tr>
<tr class="odd">
<td align="left">Other</td>
</tr>
<tr class="even">
<td align="left">Probiotic</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Here is the first 5 rows of the med_grp data.frame</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(med_grp, <span class="dv">5</span>)) </span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">MEDICATION_NAME</th>
<th align="left">med_type</th>
<th align="left">new_med_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Adalimumab</td>
<td align="left">Biologic</td>
<td align="left">Adalimumab</td>
</tr>
<tr class="even">
<td align="left">Amoxicillin</td>
<td align="left">Antibiotics</td>
<td align="left">Amoxicillin</td>
</tr>
<tr class="odd">
<td align="left">Amoxicillin / Clavulanate</td>
<td align="left">Antibiotics</td>
<td align="left">Amoxicillin</td>
</tr>
<tr class="even">
<td align="left">Azathioprine</td>
<td align="left">Immunomodulators</td>
<td align="left">Azathioprine</td>
</tr>
<tr class="odd">
<td align="left">Balsalazide</td>
<td align="left">Aminosalicylates</td>
<td align="left">Balsalazide</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Here is how Infliximab and its&#39; bio-similars are mapped </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(med_grp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(new_med_name <span class="sc">==</span> <span class="st">&quot;Infliximab&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">MEDICATION_NAME</th>
<th align="left">med_type</th>
<th align="left">new_med_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Infliximab (Remsima)</td>
<td align="left">Biologic</td>
<td align="left">Infliximab</td>
</tr>
<tr class="even">
<td align="left">Infliximab (Unspecified)</td>
<td align="left">Biologic</td>
<td align="left">Infliximab</td>
</tr>
<tr class="odd">
<td align="left">Remicade</td>
<td align="left">Biologic</td>
<td align="left">Infliximab</td>
</tr>
<tr class="even">
<td align="left">Remsima</td>
<td align="left">Biologic</td>
<td align="left">Infliximab</td>
</tr>
<tr class="odd">
<td align="left">Infliximab</td>
<td align="left">Biologic</td>
<td align="left">Infliximab</td>
</tr>
<tr class="even">
<td align="left">Infliximab (Remicade)</td>
<td align="left">Biologic</td>
<td align="left">Infliximab</td>
</tr>
<tr class="odd">
<td align="left">Infliximab-abda (Renflexis)</td>
<td align="left">Biologic</td>
<td align="left">Infliximab</td>
</tr>
<tr class="even">
<td align="left">Infliximab-axxq (Avsola)</td>
<td align="left">Biologic</td>
<td align="left">Infliximab</td>
</tr>
<tr class="odd">
<td align="left">Infliximab-dyyb (Inflectra)</td>
<td align="left">Biologic</td>
<td align="left">Infliximab</td>
</tr>
<tr class="even">
<td align="left">Renflexis</td>
<td align="left">Biologic</td>
<td align="left">Infliximab</td>
</tr>
<tr class="odd">
<td align="left">Avsola</td>
<td align="left">Biologic</td>
<td align="left">Infliximab</td>
</tr>
<tr class="even">
<td align="left">Inflectra</td>
<td align="left">Biologic</td>
<td align="left">Infliximab</td>
</tr>
<tr class="odd">
<td align="left">Infliximab-abda</td>
<td align="left">Biologic</td>
<td align="left">Infliximab</td>
</tr>
<tr class="even">
<td align="left">Infliximab-axxq</td>
<td align="left">Biologic</td>
<td align="left">Infliximab</td>
</tr>
<tr class="odd">
<td align="left">Infliximab-dyyb</td>
<td align="left">Biologic</td>
<td align="left">Infliximab</td>
</tr>
</tbody>
</table>
<p>To see the entire med_grp data.frame click
<a href="https://github.com/ccf-tfehlmann/ibdplexus/blob/79168cbffa523ab8da142d250133e70f625e00c7/data/med_grp.rda"><code>here</code></a></p>
<p><code>sparc_med_filter</code> requires the following SPARC domains to
be loaded:</p>
<ul>
<li><p>prescriptions</p></li>
<li><p>observations</p></li>
<li><p>demographics</p></li>
<li><p>encounter</p></li>
</ul>
<p>One must also supply the med_groups of interest which corresponds to
the med_type in the med_grp data.frame.</p>
<p><code>sparc med filter</code> subsets the prescriptions table to just
the medication types specified in med_groups. The leading question on
medications is located in the observations table.</p>
<p>In the baseline survey, a patient is asked if they are currently
taking any medications for their IBD. If they answer “No” they are
flagged as having no medications at enrollment. It is important to note
that antibiotics and probiotics are asked about separately in the
patient surveys.</p>
<p>In the quarterly follow-up surveys, a patient is asked if they have
had any changes in their IBD medication. If a patient indicates they
have not had any medication changes, the data from the previous survey
is pulled forward.</p>
<p><code>sparc med filter</code> uses grep to search through the
MEDICATION, OTHER_MEDICATION and SRC_DRUG_CODE_CONCEPT_NAME columns in
the prescription table. If the medication of interest is found, it
subsets the data and maps the medication to the standardized name
(new_med_name).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Load EMR and eCRF data necessary for sparc_med_filter </span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">load_data</span>(<span class="at">datadir =</span> <span class="st">&quot;~/r_input/&quot;</span>, <span class="at">cohort =</span> <span class="st">&quot;SPARC&quot;</span>, <span class="at">domains =</span> <span class="fu">c</span>(<span class="st">&quot;prescriptions&quot;</span>, <span class="st">&quot;observations&quot;</span>, <span class="st">&quot;demographics&quot;</span>, <span class="st">&quot;encounter&quot;</span>), <span class="at">data_type =</span> <span class="st">&quot;Both&quot;</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter SPARC IBD data for biologics &amp; immunomodulators </span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>meds_of_interest <span class="ot">&lt;-</span> <span class="fu">sparc_med_filter</span>(</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>prescriptions,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>observations,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>demographics,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>encounter,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">med_groups =</span> <span class="fu">c</span>(<span class="st">&quot;Biologic&quot;</span>,<span class="st">&quot;Immunomodulators&quot;</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="finding-the-first-instance-of-a-medication" class="section level1">
<h1>Finding the First Instance of a Medication</h1>
<p><code>sparc_med_starts</code> looks at a patients treatment journey
utilizing EMR and eCRF data. It is designed to find the first instance
of a medication. It is only appropriate for long term medications that
we do not expect to re-start. We assume biologics, aminosalicylates and
immunomodulators fit this description. It returns a data.frame with the
first medication start date for each drug, and an end date if
available.</p>
<p>It calls <code>sparc_med_filter</code> to filter for the medications
of interest. It is recommended to only use those medications that a
patient is on long term and unlikely to restart.</p>
<p>Medication start and stop dates are chosen independently from both
eCRF and EMR sources. Medications with a start or stop date before 1980
are dropped.</p>
<p>For EMR data, if a medication start date is missing, the visit
encounter start date is used. These records are flagged in the column
VISIT_ENCOUNTER_MED_START.</p>
<p>If a patient has medication information for the same drug from eCRF
and EMR, the eCRF data is preferred and used to generate MED_START_DATE
and MED_END_DATE. If only EMR data is available for that medication,
then EMR data is used.</p>
<p>Any overlap between medications is reported along with the number of
days the medications overlap.</p>
<p>If no end date is given for a prescription, the duration of the
overlap is calculated assuming an ongoing prescription. The effective
end date is set using a database wide cutoff based on the the date of
the latest encounter any patient had (as returned by the function
<code>extract_latest</code>.</p>
<p><code>sparc_med_starts</code> creates a table with the following
columns:</p>
<table>
<colgroup>
<col width="16%" />
<col width="83%" />
</colgroup>
<tbody>
<tr class="odd">
<td>Column</td>
<td>Description</td>
</tr>
<tr class="even">
<td>DEIDENTIFIED_MASTER_PATIENT_ID</td>
<td>Unique patient id</td>
</tr>
<tr class="odd">
<td>MEDICATION</td>
<td>Corresponds to new_med_name in the med_grp data.frame</td>
</tr>
<tr class="even">
<td>MED_START_DATE_ECRF</td>
<td>Medication Start Date from the eCRF data source</td>
</tr>
<tr class="odd">
<td>MED_END_DATE_ECRF</td>
<td>Medication End Date from the eCRF data source</td>
</tr>
<tr class="even">
<td>CURRENT_MEDICATION_ECRF</td>
<td>YES if the medication is current, NO if the medication has been
stopped</td>
</tr>
<tr class="odd">
<td>NUMBER_OF_DOSE_CHANGES_ECRF</td>
<td>Counts the number of times a patient reported a change in dose. This
field is free text and the r script only parses out numbers.</td>
</tr>
<tr class="even">
<td>NUMBER_OF_FREQ_CHANGES_ECRF</td>
<td>Counts the number of times a patient reported a change in medication
frequency.</td>
</tr>
<tr class="odd">
<td>REASON_STOPPED_ECRF</td>
<td>Lists the reason stopped if available. A medication may be current,
but have a reason stopped populated because of a dose and/or frequency
change.</td>
</tr>
<tr class="even">
<td>VISIT_ENCOUNTER_MED_START</td>
<td>For EMR data, flags if a medication start date is missing and the
visit encounter start date was used instead</td>
</tr>
<tr class="odd">
<td>MED_START_DATE_EMR</td>
<td>Medication Start Date from the EMR data source</td>
</tr>
<tr class="even">
<td>MED_END_DATE_EMR</td>
<td>Medication End Date from the EMR data source</td>
</tr>
<tr class="odd">
<td>LOADING_DOSE_EMR</td>
<td><p>1 if a patients prescription pattern for specific biologics
represents the loading pattern of that medication.</p>
<table>
<colgroup>
<col width="20%" />
<col width="79%" />
</colgroup>
<thead>
<tr class="header">
<th>Biologic</th>
<th>Criteria</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Infliximab</td>
<td>Prescriptions at 0,2,6 and then every 8 weeks</td>
</tr>
<tr class="even">
<td>Adalimumab</td>
<td>Every 2 weeks with the first dose as 160mg, then 80 mg, then 40mg
going forward</td>
</tr>
<tr class="odd">
<td>Certolizumab Pegol</td>
<td>Prescriptions at 0,2,4 and then every 4 weeks</td>
</tr>
<tr class="even">
<td>VedolizInumab</td>
<td>Prescriptions at 0,2,6 and then every 8 weeks</td>
</tr>
<tr class="odd">
<td>Ustekinumab</td>
<td>Initial dose as an IV and then subcutaneous injection every 8
weeks</td>
</tr>
</tbody>
</table></td>
</tr>
<tr class="even">
<td>PRESCRIPTION_NUMBER_EMR</td>
<td>Number of rows for this medication in the prescription emr data</td>
</tr>
<tr class="odd">
<td>MEDICATION_REFILLS_EMR</td>
<td>Number of refills from most recent prescription in the EMR data</td>
</tr>
<tr class="even">
<td>ECRF_PRESCRIPTION_DATA</td>
<td>1 if data for this medication is available in the eCRF data
source</td>
</tr>
<tr class="odd">
<td>MED_START_DATE</td>
<td>If ECRF_PRESCRIPTION_DATA = 1, then from MED_START_DATE_ECRF, else
from MED_START_DATE_EMR.</td>
</tr>
<tr class="even">
<td>MED_END_DATE</td>
<td>If ECRF_PRESCRIPTION_DATA = 1, then from MED_END_DATE_ECRF, else
from MED_END_DATE_EMR.</td>
</tr>
<tr class="odd">
<td>MOA</td>
<td>The mechanism of action for each medication. Includes, antiTNF,
Aminosalicylates, Immunomodulators, Interleukin-12 and -23 Antagonist,
JAKi, Integrin Receptor Antagonists, S1P</td>
</tr>
<tr class="even">
<td>MEDICATION_NUMBER</td>
<td>counts the number of different medications in a patients’ journey.
Only medications in the selected med_groups are considered. The
medication with with earliest start date will have MEDICATION_NUMBER =
1.</td>
</tr>
<tr class="odd">
<td>OVERLAPPING_MOA</td>
<td>If multiple medications overlap, the overlapping MOA is listed
here</td>
</tr>
<tr class="even">
<td>OVERLAPPING_DAYS</td>
<td>The number of days the medication overlaps with another MOA</td>
</tr>
<tr class="odd">
<td>DATE_OF_CONSENT</td>
<td>The date of enrollment into SPARC for the patient</td>
</tr>
<tr class="even">
<td>DATE_OF_CONSENT_WITHDRAWN</td>
<td>The date of withdrawal from SPARC, if applicable</td>
</tr>
<tr class="odd">
<td>STARTED_AFTER_ENROLLMENT</td>
<td>is 1 if the medication start date is after the date of consent.</td>
</tr>
<tr class="even">
<td>NO_CURRENT_IBD_MEDICATION_AT_ENROLLMENT</td>
<td>1 if a patient indicates “No” to “Are you currently on any IBD
medications?” at their baseline survey.</td>
</tr>
<tr class="odd">
<td>BIOLOGIC</td>
<td>is 1 if the record is for a biologic</td>
</tr>
<tr class="even">
<td>FIRST_BIOLOGIC</td>
<td>is 1 if a medication record is the first biologic a patient
receives.</td>
</tr>
<tr class="odd">
<td>FIRST_BIOLOGIC_NUMBER</td>
<td> If a record is the first biologic a patient receives,
FIRST_BIOLOGIC_NUMBER is equal to the MEDICATION_NUMBER.</td>
</tr>
<tr class="even">
<td>BIONAIVE</td>
<td>is 1 if patient has no prior reported biologic use</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Find Medication Start Dates for Biologics and Immunomodulators. </span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># If export = TRUE then an excel spreadsheet is generated. </span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>medication_starts <span class="ot">&lt;-</span> <span class="fu">sparc_med_starts</span>(</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>prescriptions,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>observations,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>demographics,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>encounter,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">med_groups =</span> <span class="fu">c</span>(<span class="st">&quot;Biologic&quot;</span>,<span class="st">&quot;Immunomodulators&quot;</span>),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">export =</span> <span class="cn">TRUE</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="medication-at-a-specific-time-point" class="section level1">
<h1>Medication at a Specific Time-point</h1>
<p>This medication journey can then be used to find the medications a
patient is on at a specific time point using the
<code>sparc_medication</code> function. This time point is referred to
as an “index” date. The function looks to see if the index date is
within the medication start and stop dates as generated by the
<code>sparc_med_starts</code> function.</p>
<p><code>sparc_medication</code> includes pre-programmed index dates for
enrollment, latest, endoscopy, omics and biosample collection. A data
frame with the DEIDENTIFIED_MASTER_PATIENT_ID and index_date can also be
passed into the function. If “Enrollment” is specified as the index,
then only the patient reported data (MED_START_DATE_ECRF &amp;
MED_END_DATE_ECRF) is used to determine what medication a patient is on
as this data is very robust at this time point. If two medications of
the same MOA overlap, the start of the 2nd medication is used as the end
date of the previous medication.</p>
<p><code>sparc_medication</code> also requires a list of data.frames as
generated by <code>load_data</code> which must include demographics,
diagnosis, encounter, procedures, observations, biosample,
omics_patient_mapping, and prescriptions.</p>
<p>Currently, this function does not support steroid or antibiotic use.
Functions to parse out this information are in development.</p>
<p>A data.frame and excel file is generated with the following
columns:</p>
<table>
<colgroup>
<col width="24%" />
<col width="75%" />
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Column</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="even">
<td>DEIDENTIFIED_MASTER_PATIENT_ID</td>
<td>Unique patient id</td>
</tr>
<tr class="odd">
<td>DATE_OF_CONSENT</td>
<td>The date of enrollment into SPARC for the patient</td>
</tr>
<tr class="even">
<td>DATE_OF_CONSENT_WITHDRAWN</td>
<td>The date of withdrawal from SPARC, if applicable</td>
</tr>
<tr class="odd">
<td>BIRTH_YEAR</td>
<td>Year of patients birth</td>
</tr>
<tr class="even">
<td>SEX</td>
<td>Male, Female or Unknown</td>
</tr>
<tr class="odd">
<td>DIAGNOSIS</td>
<td>Crohn’s Disease, Ulcerative Colitis, or IBD Unclassified</td>
</tr>
<tr class="even">
<td>DIAGNOSIS_DATE</td>
<td>Date of IBD Diagnosis</td>
</tr>
<tr class="odd">
<td>INDEX_DATE</td>
<td>Date of interest as specified in “index_info”</td>
</tr>
<tr class="even">
<td>NO_CURRENT_IBD_MEDICATION_AT_ENROLLMENT</td>
<td>1 if a patient indicates “No” to “Are you currently on any IBD
medications?” at their baseline survey.</td>
</tr>
<tr class="odd">
<td>MEDICATION_AT_INDEX</td>
<td>A concatenated list of medications the patient is on based on if the
index date falls between the medication start and stop date.</td>
</tr>
<tr class="even">
<td>BIONAIVE</td>
<td>is 1 if patient has no prior reported biologic use</td>
</tr>
<tr class="odd">
<td>MED_START_DATE_ECRF_XXX</td>
<td>The start date in the ECRF for medication XXX</td>
</tr>
<tr class="even">
<td>MED_END_DATE_ECRF_XXX</td>
<td>The end date in the ECRF for medication XXX</td>
</tr>
<tr class="odd">
<td>MED_START_DATE_EMR_XXX</td>
<td>The start date in the EMR for medication XXX</td>
</tr>
<tr class="even">
<td>MED_END_DATE_EMR_XXX</td>
<td>The end date in the EMR for medication XXX</td>
</tr>
<tr class="odd">
<td>CURRENT_MEDICATION_ECRF_XXX</td>
<td>The current medication flag (yes/no) from eCRF for medication
XXX</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Data needed for sparc_medication function </span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">load_data</span>(<span class="at">datadir =</span> <span class="st">&quot;~/r_input/&quot;</span>, <span class="at">cohort =</span> <span class="st">&quot;SPARC&quot;</span>, <span class="at">domains =</span> <span class="fu">c</span> (<span class="st">&quot;demographics&quot;</span>, <span class="st">&quot;diagnosis&quot;</span>, <span class="st">&quot;encounter&quot;</span>, <span class="st">&quot;procedures&quot;</span>, <span class="st">&quot;observations&quot;</span>, <span class="st">&quot;biosample&quot;</span>, <span class="st">&quot;omics_patient_mapping&quot;</span>,<span class="st">&quot;prescriptions&quot;</span>), <span class="at">data_type =</span> <span class="st">&quot;Both&quot;</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Find Biologics and Immunomodulators a patient is on at enrollment. </span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>med_at_enrollment <span class="ot">&lt;-</span> <span class="fu">sparc_medication</span>(</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">index_info =</span> <span class="st">&quot;Enrollment&quot;</span>,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">med_groups =</span> <span class="fu">c</span>(<span class="st">&quot;Biologic&quot;</span>, <span class="st">&quot;Immunomodulators&quot;</span>),</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">&quot;SPARC_MEDICATION_AT_ENROLLMENT.xlsx&quot;</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Find Biologics and Immunomodulators a patient is on at endoscopy</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>med_at_enrollment <span class="ot">&lt;-</span> <span class="fu">sparc_medication</span>(</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">index_info =</span> <span class="st">&quot;Endoscopy&quot;</span>,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">med_groups =</span> <span class="fu">c</span>(<span class="st">&quot;Biologic&quot;</span>, <span class="st">&quot;Immunomodulators&quot;</span>),</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">&quot;SPARC_MEDICATION_AT_ENDOSCOPY.xlsx&quot;</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
